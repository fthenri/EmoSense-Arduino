import serial
import time
import os
import tkinter as tk
from tkinter import Label
from PIL import Image, ImageTk
import threading

# Configuração da porta serial
ser = serial.Serial('COM6', 9600, timeout=1)

# Função para mostrar imagem 1
def show_image1():
    img = Image.open(r"C:\Users\gmvc\OneDrive\Documentos\Guilherme Mourão\GMVC\Emosense\EmoSense-Arduino\imagem1.jpg")
    img = img.resize((250, 250), Image.LANCZOS)
    img_tk = ImageTk.PhotoImage(img)
    panel.configure(image=img_tk)
    panel.image = img_tk
    print("Opção 1 selecionada")

# Função para mostrar imagem 2
def show_image2():
    img = Image.open(r"C:\Users\gmvc\OneDrive\Documentos\Guilherme Mourão\GMVC\Emosense\EmoSense-Arduino\imagem2.jpg")
    img = img.resize((250, 250), Image.LANCZOS)
    img_tk = ImageTk.PhotoImage(img)
    panel.configure(image=img_tk)
    panel.image = img_tk
    print("Opção 2 selecionada")

# Função para mostrar imagem 3
def show_image3():
    img = Image.open(r"C:\Users\gmvc\OneDrive\Documentos\Guilherme Mourão\GMVC\Emosense\EmoSense-Arduino\imagem3.png")
    img = img.resize((250, 250), Image.LANCZOS)
    img_tk = ImageTk.PhotoImage(img)
    panel.configure(image=img_tk)
    panel.image = img_tk
    print("Opção 3 selecionada")
def show_image4():
    img = Image.open(r"C:\Users\gmvc\OneDrive\Documentos\Guilherme Mourão\GMVC\Emosense\EmoSense-Arduino\images.png")
    img = img.resize((250, 250), Image.LANCZOS)
    img_tk = ImageTk.PhotoImage(img)
    panel.configure(image=img_tk)
    panel.image = img_tk
    print("Opção 4 selecionada")

# Função para ler os dados da serial e atualizar a interface
def read_serial():
    while True:
        if ser.in_waiting > 0:
            data = ser.readline().decode('utf-8').strip()
            if data:
                print(f"Received: {data}")
                if data == "btn1":
                    show_image1()
                elif data == "btn2":
                    show_image2()
                elif data == "btn3":
                    show_image3()
                elif data == "btn4":
                    show_image4()

# Inicializa a interface gráfica
root = tk.Tk()
root.title("Interface Serial com Tkinter")

# Configura o painel para mostrar imagens
panel = Label(root)
panel.pack(side="bottom", fill="both", expand="yes")

if __name__ == "__main__":
    print("Aguardando dados do Arduino...")
    time.sleep(2)  # Tempo para garantir que a conexão serial esteja estável
    
    # Inicia a leitura dos dados da serial em um thread separado para não bloquear a interface
    thread = threading.Thread(target=read_serial)
    thread.daemon = True
    thread.start()
    
    # Inicia o loop principal da interface Tkinter
    root.mainloop()
